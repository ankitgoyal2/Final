<!DOCTYPE html>
<html>
    <head>
       
       
        <meta name="format-detection" content="telephone=no">
        <meta name="msapplication-tap-highlight" content="no">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="../css/login.css">
         <link rel="stylesheet" type="text/css" href="../css/login2.css">
         <link rel="stylesheet" href="../css/bootstrap.min.css">
         <link rel = "icon" type = "image/png" href = "../img/doctorIcon.png">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
  <link rel="stylesheet" href="../css/forAll.css">

        <title>Login Form</title>

    </head>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
 <script>
      const disableButton = ()=>{
            const button = document.getElementById("login");
            button.innerText= "Logging In...";
            button.disabled = true;
            
        }

        const enableButton = ()=>{
            const button = document.getElementById("login");
            button.innerText= "Login";
            button.disabled = false;
        }


  function test()
  {
      event.preventDefault();

      disableButton();

      var email = document.getElementById("username").value;
      var password = document.getElementById("password").value;

      console.log("success");
      
      data = {
      email,
      password
    }
  

    axios.post("http://aqueous-spire-38105.herokuapp.com/d/login", data)
      .then(Response => {
        //save token to localStorage
        console.log('Login successful');
        localStorage.setItem('token', Response.data.token);
        console.log(localStorage.getItem('token'));
        window.location = "doctor_dash.html";
      })
      .catch(error => {
        if (error.response.status == 401) {
          alert(error.response.data);
        } else
          alert("Some error occured");
        console.log(error.response);
        enableButton();
      })



  }

    </script>
     
    <body>

      <div class="centre_box">

      <div class="signin-form">
        <form onsubmit="test();" method="post">
            <img src="../img\doctor.jfif" id="profile_pic">
            <h2 cl>Doctor Login</h2>
            <div class="form-group">
            <input type="email" class="form-control" placeholder="Username" required="required" id="username"/>
            </div>
            <div class="form-group">
                <input type="password" class="form-control" placeholder="Password" required="required" id="password"/>
            </div>    
            <div class="form-group">
                <button id="login" type="submit" class="btn btn-main btn-lg btn-block">Login</button>
            </div>
            <hr>
            <div class="text-center" >Forgot Password? <a href="d_forgot_password.html" class="signup-button">Forgot Password</a></div>
        </form>
    </div>
  </div>

    </div>
  </div>

        <script type="text/javascript" src="../cordova.js"></script>
        <script type="text/javascript" src="../js/login.js"></script>
    </body>
</html>
